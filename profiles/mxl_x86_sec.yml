---
profiles:
  - LGM_PRPL
target: intel_x86
subtarget: lgm
external_target: True
description: Build secure boot images for the Maxlinear x86 devices - URX.
             This target requires sources from MaxLinear, that are accessible via
             git.maxlinear.com.
             For reference boards, source code access and reporting issues,
             please check https://gitlab.com/prpl-foundation/prplos/prplos/-/wikis/MaxLinear-Open-Service-Platform
feeds:
  - name: intel_x86
    uri: ssh://git@git.maxlinear.com/ugw/feeds/feed_target_x86.git
    tracking_branch: updk_9.1.70
    revision: f9f45a9455119ebf9ebd5b9a7f5a27786f781ef2
  - name: rootfs
    uri: ssh://git@git.maxlinear.com/ugw/rootfs.git
    tracking_branch: updk_9.1.70
    revision: 279be7e422894f621f937b782a83f823fc570e32
  - name: 3rdparty
    uri: ssh://git@git.maxlinear.com/ugw/feeds/feed_3rdparty.git
    tracking_branch: master
    revision: 31ea91c9376c3bf9b958807de01440be2e0e4c75
  - name: datapath
    uri: ssh://git@git.maxlinear.com/ugw/feeds/feed_datapath.git
    tracking_branch: master
    revision: e07652bef6706900a8ab9ea1c26d6acd5dd1559c
  - name: gphy_firmware
    uri: ssh://git@git.maxlinear.com/ugw/feeds/feed_gphy_firmware.git
    tracking_branch: master
    revision: 7f53bcc7d43c8fe41417d21d50e290bb77f6c231
  - name: gwdpa_dpm
    uri: ssh://git@git.maxlinear.com/ugw/feeds/feed_gwdpa-dpm.git
    tracking_branch: master
    revision: 992ae0e7802740841d43e2f1891a47663f9ad692
  - name: misc
    uri: ssh://git@git.maxlinear.com/ugw/feeds/feed_common.git
    tracking_branch: master
    revision: 3ab18477cfb96b7ae3a5bdc065ff0ba8a98ee843
  - name: opensource_apps_prpl
    uri: ssh://git@git.maxlinear.com/ugw/feeds/feed_opensource_apps_prpl.git
    tracking_branch:  master
    revision: 46ba64f3bb9a60c6855e140bb8eb87ca14ff4f96
  - name: packet_learn
    uri: ssh://git@git.maxlinear.com/ugw/feeds/feed_packet_learn.git
    tracking_branch: updk_9.1.70_2305
    revision: e5476b2cc6aae2913dc64971f44fef0a4888e22c
  - name: pon
    uri: ssh://git@git.maxlinear.com/ugw/feeds/feed_pon.git
    tracking_branch: master
    revision: 5349c8fb541e8f35da74bf42189ec6e5922c068d
  - name: ppa
    uri: ssh://git@git.maxlinear.com/ugw/feeds/feed_ppa.git
    tracking_branch: master
    revision: 81bc6d078d26d9dc0c788de3d70959c5b15c5713
  - name: pp_net_adapter
    uri: ssh://git@git.maxlinear.com/ugw/feeds/feed_pp_net_adapter.git
    tracking_branch: master
    revision: 3000a9ef418b4c3ec6bf6bf9e59361c50afc0218
  - name: vpn_fw
    uri: ssh://git@git.maxlinear.com/ugw/feeds/feed_vpn_fw.git
    tracking_branch: master
    revision: 8e08b19977af08dc5870dfa9e169545e2220d4d4
  - name: qos
    uri: ssh://git@git.maxlinear.com/ugw/feeds/feed_qos_tc.git
    tracking_branch: master
    revision: 8904e7fbb73db1d880d7f14139cb971296275c9b
  - name: utils
    uri: ssh://git@git.maxlinear.com/ugw/feeds/feed_ugw_utils.git
    tracking_branch: updk_9.1.70
    revision: 724d222a7f2c623b1f95a73c43762d06278ed98a
  - name: bootloader
    uri: ssh://git@git.maxlinear.com/ugw/feeds/feed_uboot.git
    tracking_branch:  u-boot-2022.01_prpl_4.0.254
    revision: 7dfd47ef8b2a4d7751a7245581c2368a70293fa3
  - name: dpl
    uri: ssh://git@git.maxlinear.com/ugw/feeds/feed_dpl.git
    tracking_branch:  updk_9.1.70_2305
    revision: e06121840e86286ce4a25e63c9be35d48e7daf27
  - name: ugw_sdk
    uri: ssh://git@git.maxlinear.com/ugw/feeds/feed_ugw_sdk.git
    tracking_branch:  updk_sdklib
    revision: be2c71c5bfa2983277d55e77c75d812b4e05b3a7
  - name: system_service
    uri: ssh://git@git.maxlinear.com/ugw/feeds/feed_system_service.git
    tracking_branch:  updk_9.1.60
    revision: 6a645b341f8afa8c96223a161efa87e87dffead1
  - name: speedtest
    uri: ssh://git@git.maxlinear.com/mxl/speedtest.git
    tracking_branch:  master
    revision: 4054fd73777eec8f0319b3a6a0b936fefb815da0

packages:
  - kmod-mxl_eth_drv
  - kmod-gwdpa-dpm
  - kmod-pp_net_adapter
  - kmod-packet_learn
  - blockd
  - kmod-phy-lgm-usb
  - kmod-usb-acm
  - kmod-usb-dwc3-intel
  - kmod-usb-net-cdc-mbim
  - kmod-usb-printer
  - kmod-usb-storage-uas
  - kmod-usb-xhci-hcd
  - kmod-usb3
  - ppv4-firmware-lgm
  - kmod-intel_ppv4_fw_lgm
  - kmod-intel-extmark-x86
  - kmod-ppv4
  - kmod-p34x_phy_fwdl
  - mxl-gphy-fw-lgm
  #- netifd-ugw
  - e2fsprogs
  - kmod-directconnect-dp
  - kmod-ppa-drv
  - kmod-ppa-drv-accel
  - kmod-ppa-drv-gre
  - kmod-ppa-drv-lgm
  - kmod-ppa-drv-stack-al
  - ppacmd
  - kmod-mxl_vpn
  - kmod-mxl_lgm_toe
  - kmod-ipsec4
  - kmod-ipsec6
  - kmod-ipsec
  - eip197-firmware
  - kmod-safexcel
  - vpn-firmware-lgm
  - kmod-ipsec4-offload
  - kmod-ipsec6-offload
  - pon-libnl
  - gpon-omci-onu-binary
  - pon-mcc-lib
  - pon-lib
  - pon-net-lib
  - pon-img-lib
  - pon-tools
  - base-files-platform-lgm
  - pon-base-files
  - pon-base-files-debug
  - pon-base-files-prpl
  - pon-lib-cli
  - pon-lib-daemon
  - ponmbox-cli
  - pon-gpon-firmware-urx-b
  - pon-xpon-firmware-urx-b
  - pon-serdes-firmware-urx-b
  - kmod-pon-mbox-drv-eth
  - kmod-dp-eth-reinsert
  - kmod-pon-mcc-drv
  - kmod-pon-mcc-drv-filter
  - kmod-mxl_pon_hgu_vuni_lgm
  - ethtool
  - base-files-prpl
  - ppmd-bin
  - pm-util
  #- signingutil
  - kmod-intel-qos
  - kmod-qos-tc
  - partx-utils
  - obudpst
  - speedtest-modules
  - kmod-dpl
  - kmod-gpio-button-hotplug
  - kmod-mxl_gpy
  - libhelper
  - libscapi
  - libugwhelper
  - libmsgapi
  - kmod-sse_driver_lgm
  - kmod-sse_ssal_driver_lgm
  - sse_fapi_lgm
  - sse_fapi_lgm-sse_test_app
  #- secure-utils
  - fwupgrade

diffconfig: |
  CONFIG_DEVEL=y
  CONFIG_KERNEL_GIT_CLONE_URI="git@git.maxlinear.com:mxl/linux.git"
  CONFIG_KERNEL_GIT_REF="UPDK_9.1.70_2305"
  CONFIG_GPON_OMCI_ONU_UBUS_INTERFACE=y
  CONFIG_TARGET_MULTI_PROFILE=y
  CONFIG_TARGET_PER_DEVICE_ROOTFS=y
  CONFIG_TARGET_DEVICE_intel_x86_lgm_DEVICE_LGM_PRPL=y
  # CONFIG_TARGET_ROOTFS_EXT4FS is not set
  CONFIG_BUILD_LOG=y
  CONFIG_PACKAGE_uboot-lgp-urx851-sec-p34x-phy-emmc-prpl=y
  CONFIG_VERSION_FILENAMES=n
  CONFIG_VERSION_CODE_FILENAMES=n
  # CONFIG_PACKAGE_bios_images is not set
  CONFIG_BUILD_SDK="prplos"
  CONFIG_IMAGEOPT=y
  CONFIG_PACKAGE_kmod-intel-icc-regmap-x86=y
  CONFIG_PACKAGE_kmod-mxl_gpy=y
  CONFIG_PACKAGE_kmod-mxl_icc_driver=y
  CONFIG_PACKAGE_kmod-mxl_mps2_driver=y
  CONFIG_PACKAGE_kmod-intel_noc_firewall=y
  CONFIG_INTEL_X86_SECBOOT=y
  CONFIG_INTEL_X86_AIC_BASEADDR=0x010000000
  CONFIG_INTEL_X86_CERTIFICATION="<Custom-Path-To-384-bit_certificate>"
  CONFIG_INTEL_X86_CERTIFICATION_SUPPORT=y
  CONFIG_INTEL_X86_DTB_ROLLBACKID=0x4
  CONFIG_INTEL_X86_ENC_KEY="ENCkey.bin"
  CONFIG_INTEL_X86_KERNEL_BASEADDR=0x8200000
  CONFIG_INTEL_X86_KERNEL_METADATA=y
  CONFIG_INTEL_X86_KERNEL_ROLLBACKID=0x4
  CONFIG_INTEL_X86_PRIVATE_KEY="<Custom-Path-To-384-bit_ecdsa_keypair>"
  CONFIG_INTEL_X86_PROD_UNIQUE_KEY="<Custom-Path-To-256-bit_hw_unique_key>"
  CONFIG_INTEL_X86_ROOTFS_ROLLBACKID=0x4
  CONFIG_INTEL_X86_SIGNTOOL="<Custom-Path-To-Signtool>"
  CONFIG_INTEL_X86_TEP_BASEADDR=0x8200000
  CONFIG_INTEL_X86_TEP_ROLLBACKID=0x4
  # CONFIG_INTEL_X86_EXTERNAL_IMAGE_SIGNING=y
  # CONFIG_INTEL_X86_SIGNING_SER_USER=""
  # CONFIG_INTEL_X86_SIGNING_SER_PASS=""
  CONFIG_BUSYBOX_CUSTOM=y
  CONFIG_BUSYBOX_CONFIG_TFTPD=y
  CONFIG_BUSYBOX_CONFIG_FEATURE_TFTP_GET=y
  CONFIG_BUSYBOX_CONFIG_FEATURE_TFTP_PUT=y
  CONFIG_BUSYBOX_CONFIG_TFTP=y
  CONFIG_KERNEL_FTRACE=y
